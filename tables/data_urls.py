

url_list = [
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2025_02_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2025_01_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_12_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_11_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_10_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_09_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_08_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_07_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_06_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_05_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_04_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_03_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_02_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2024_01_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2023q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2023q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2023q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2023q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2022q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2022q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2022q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2022q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2021q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2021q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2021q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2021q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2020q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2020q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2020q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2020q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2019q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2019q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2019q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2019q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2018q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2018q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2018q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2018q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2017q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2017q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2017q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2017q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2016q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2016q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2016q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2016q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2015q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2015q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2015q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2015q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2014q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2014q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2014q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2014q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2013q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2013q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2013q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2013q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2012q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2012q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2012q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2012q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2011q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2011q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2011q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2011q1_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2010q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2010q3_notes_0.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2010q2_notes_0.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2010q1_notes_1.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2009q4_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2009q3_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2009q2_notes.zip",
# "https://www.sec.gov/files/dera/data/financial-statement-notes-data-sets/2009q1_notes.zip"
]

import os
import time
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.chrome.service import Service
from urllib.parse import urlparse

def download_with_selenium(url, output_dir="downloads", wait_time=30):
    """
    Download a file using Selenium and Chrome WebDriver.
    
    Args:
        url (str): URL to download
        output_dir (str): Directory to save downloaded file
        wait_time (int): Time to wait for download to complete (seconds)
        
    Returns:
        bool: True if successful, False otherwise
    """
    try:
        # Create output directory if it doesn't exist
        if not os.path.exists(output_dir):
            os.makedirs(output_dir)
            
        # Set up Chrome options
        chrome_options = Options()
        
        # Set download directory
        prefs = {
            "download.default_directory": os.path.abspath(output_dir),
            "download.prompt_for_download": False,
            "download.directory_upgrade": True,
            "safebrowsing.enabled": False
        }
        chrome_options.add_experimental_option("prefs", prefs)
        
        # Add headers for SEC.gov
        chrome_options.add_argument("--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36")
        
        # Create a new Chrome WebDriver
        driver = webdriver.Chrome(options=chrome_options)
        
        # Navigate to the URL
        print(f"Navigating to {url}...")
        driver.get(url)
        
        # Extract expected filename from URL
        parsed_url = urlparse(url)
        expected_filename = os.path.basename(parsed_url.path)
        expected_filepath = os.path.join(output_dir, expected_filename)
        
        # Wait for download to complete
        print(f"Waiting for download to complete (up to {wait_time} seconds)...")
        start_time = time.time()
        while time.time() - start_time < wait_time:
            if os.path.exists(expected_filepath):
                print(f"Download complete: {expected_filepath}")
                driver.quit()
                return True
            time.sleep(1)
            
        # Check if any file was downloaded (in case the filename is different)
        files_before = set(os.listdir(output_dir))
        time.sleep(2)  # Give a little more time
        files_after = set(os.listdir(output_dir))
        new_files = files_after - files_before
        
        if new_files:
            print(f"Downloaded file(s): {', '.join(new_files)}")
            driver.quit()
            return True
        
        print("Download failed or timed out")
        driver.quit()
        return False
        
    except Exception as e:
        print(f"Error during Selenium download: {str(e)}")
        try:
            driver.quit()
        except:
            pass
        return False

def download_sec_file_selenium(url, output_dir="downloads"):
    """
    Download a file from SEC.gov using Selenium.
    
    Args:
        url (str): The SEC.gov URL to download
        output_dir (str): Directory to save downloaded file
        
    Returns:
        bool: True if successful, False otherwise
    """
    print(f"Downloading SEC file: {url}")
    success = download_with_selenium(url, output_dir)
    if success:
        print("SEC file downloaded successfully")
    else:
        print("Failed to download SEC file")
    return success

if __name__ == "__main__":
    import argparse
    
    parser = argparse.ArgumentParser(description="Download content from SEC.gov using Selenium")
    parser.add_argument("url", help="SEC.gov URL to download")
    parser.add_argument("-o", "--output", default="downloads", help="Output directory (default: downloads)")
    parser.add_argument("-w", "--wait", type=int, default=60, help="Maximum wait time in seconds (default: 30)")
    
    args = parser.parse_args()

    if len(args.output) < 3:
        file_path  = "/mnt/usb-TOSHIBA_External_USB_3.0_20141121000522F-0:0-part1/sullija/sec_data"
    else:
        url = args.url

    if len(args.url) > 2:
        url_list = [args.url]
    
    for i in range(len(url_list)):
        download_with_selenium(url_list[i], args.output, args.wait)